<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jurnal Digital 7 Kebiasaan Anak Indonesia Hebat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            box-sizing: border-box;
        }
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .habit-card {
            transition: all 0.3s ease;
        }
        .habit-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .modal-overlay {
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Login Page -->
    <div id="loginPage" class="min-h-screen gradient-bg flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl card-shadow p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="bg-blue-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-book-open text-blue-600 text-3xl"></i>
                </div>
                <h1 class="text-2xl font-bold text-gray-800 mb-2">Jurnal Digital</h1>
                <p class="text-gray-600">7 Kebiasaan Anak Indonesia Hebat</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                    <input type="text" id="username" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Masukkan username">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                    <input type="password" id="password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Masukkan password">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Role</label>
                    <select id="role" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">Pilih Role</option>
                        <option value="admin">Admin</option>
                        <option value="guru">Guru Wali</option>
                        <option value="siswa">Siswa</option>
                    </select>
                </div>
                
                <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition duration-200 font-medium">
                    Masuk
                </button>
                
                <div class="text-center text-sm text-gray-500 mt-4">
                    <p>Demo Login - Password: <strong>123456</strong></p>
                </div>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="hidden">
        <nav class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <i class="fas fa-user-shield text-blue-600 text-xl mr-3"></i>
                        <h1 class="text-xl font-semibold text-gray-800">Dashboard Admin</h1>
                    </div>
                    <button onclick="logout()" class="text-red-600 hover:text-red-800 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                    </button>
                </div>
            </div>
        </nav>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Manajemen Guru Wali -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-chalkboard-teacher text-green-600 mr-3"></i>
                        Manajemen Guru Wali
                    </h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Guru</label>
                            <input type="text" id="namaGuru" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Masukkan nama guru">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jabatan Guru</label>
                            <input type="text" id="jabatanGuru" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Contoh: Guru Wali Kelas">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jurusan (dapat memilih lebih dari satu)</label>
                            <div class="grid grid-cols-2 gap-2">
                                <label class="flex items-center">
                                    <input type="checkbox" class="jurusan-guru mr-2" value="IPA"> IPA
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="jurusan-guru mr-2" value="IPS"> IPS
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="jurusan-guru mr-2" value="Bahasa"> Bahasa
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="jurusan-guru mr-2" value="Agama"> Agama
                                </label>
                            </div>
                        </div>
                        
                        <button onclick="tambahGuru()" class="w-full bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition duration-200">
                            Tambah Guru Wali
                        </button>
                        
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload File Excel Guru</label>
                            <input type="file" id="fileGuru" accept=".xlsx,.xls" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <button onclick="downloadTemplateGuru()" class="mt-2 w-full bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition duration-200">
                                Download Template Excel
                            </button>
                            <button onclick="uploadGuru()" class="mt-2 w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-200">
                                Upload Data Guru
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Manajemen Siswa -->
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-user-graduate text-blue-600 mr-3"></i>
                        Manajemen Siswa
                    </h2>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Nama Siswa</label>
                            <input type="text" id="namaSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Masukkan nama siswa">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                            <select id="kelasSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Pilih Kelas</option>
                                <option value="X">X</option>
                                <option value="XI">XI</option>
                                <option value="XII">XII</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jurusan</label>
                            <select id="jurusanSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Pilih Jurusan</option>
                                <option value="IPA">IPA</option>
                                <option value="IPS">IPS</option>
                                <option value="Bahasa">Bahasa</option>
                                <option value="Agama">Agama</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Agama</label>
                            <select id="agamaSiswaAdmin" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                <option value="">Pilih Agama</option>
                                <option value="Islam">Islam</option>
                                <option value="Kristen">Kristen</option>
                                <option value="Katolik">Katolik</option>
                                <option value="Hindu">Hindu</option>
                                <option value="Buddha">Buddha</option>
                                <option value="Konghucu">Konghucu</option>
                            </select>
                        </div>
                        
                        <button onclick="tambahSiswa()" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-200">
                            Tambah Siswa
                        </button>
                        
                        <div class="border-t pt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upload File Excel Siswa</label>
                            <input type="file" id="fileSiswa" accept=".xlsx,.xls" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <button onclick="downloadTemplateSiswa()" class="mt-2 w-full bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700 transition duration-200">
                                Download Template Excel
                            </button>
                            <button onclick="uploadSiswa()" class="mt-2 w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-200">
                                Upload Data Siswa
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Penautkan Guru dengan Siswa -->
            <div class="mt-8 bg-white rounded-xl card-shadow p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-link text-purple-600 mr-3"></i>
                    Penautkan Guru Wali dengan Siswa
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Pilih Guru Wali</label>
                        <select id="pilihGuru" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500">
                            <option value="">Pilih Guru Wali</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Pilih Siswa untuk Monitoring</label>
                        <div class="mb-3">
                            <select id="filterJurusanSiswa" onchange="updateDaftarSiswa()" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                                <option value="">Semua Jurusan</option>
                                <option value="IPA">IPA</option>
                                <option value="IPS">IPS</option>
                                <option value="Bahasa">Bahasa</option>
                                <option value="Agama">Agama</option>
                            </select>
                        </div>
                        <div id="daftarSiswa" class="max-h-40 overflow-y-auto border border-gray-300 rounded-lg p-3">
                            <!-- Siswa akan dimuat di sini -->
                        </div>
                    </div>
                </div>
                
                <button onclick="tautkanGuruSiswa()" class="mt-4 bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition duration-200">
                    Tautkan Guru dengan Siswa
                </button>
            </div>

            <!-- Tabel Data Jurusan -->
            <div class="mt-8 bg-white rounded-xl card-shadow p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 flex items-center">
                        <i class="fas fa-graduation-cap text-purple-600 mr-3"></i>
                        Data Jurusan
                    </h3>
                    <div class="flex gap-2">
                        <button onclick="showTambahJurusan()" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition duration-200 text-sm">
                            <i class="fas fa-plus mr-2"></i>Tambah Jurusan
                        </button>
                        <button onclick="downloadTemplateJurusan()" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition duration-200 text-sm">
                            <i class="fas fa-download mr-2"></i>Template Excel
                        </button>
                        <input type="file" id="fileJurusan" accept=".xlsx,.xls" class="hidden">
                        <button onclick="document.getElementById('fileJurusan').click()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200 text-sm">
                            <i class="fas fa-upload mr-2"></i>Upload Excel
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left">Kode Jurusan</th>
                                <th class="px-4 py-2 text-left">Nama Jurusan</th>
                                <th class="px-4 py-2 text-left">Deskripsi</th>
                                <th class="px-4 py-2 text-left">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tabelJurusan" class="divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tabel Data Mapping Guru Wali - Siswa -->
            <div class="mt-8 bg-white rounded-xl card-shadow p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-sitemap text-indigo-600 mr-3"></i>
                    Data Mapping Guru Wali - Siswa
                </h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left">Guru Wali</th>
                                <th class="px-4 py-2 text-left">Jurusan Guru</th>
                                <th class="px-4 py-2 text-left">Siswa yang Dibimbing</th>
                                <th class="px-4 py-2 text-left">Jumlah Siswa</th>
                                <th class="px-4 py-2 text-left">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tabelMapping" class="divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tabel Data -->
            <div class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white rounded-xl card-shadow p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Data Guru Wali</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left">Nama</th>
                                    <th class="px-4 py-2 text-left">Jabatan</th>
                                    <th class="px-4 py-2 text-left">Jurusan</th>
                                    <th class="px-4 py-2 text-left">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tabelGuru" class="divide-y divide-gray-200">
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="bg-white rounded-xl card-shadow p-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Data Siswa</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-2 text-left">Nama</th>
                                    <th class="px-4 py-2 text-left">Kelas</th>
                                    <th class="px-4 py-2 text-left">Jurusan</th>
                                    <th class="px-4 py-2 text-left">Agama</th>
                                    <th class="px-4 py-2 text-left">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="tabelSiswa" class="divide-y divide-gray-200">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Guru Dashboard -->
    <div id="guruDashboard" class="hidden">
        <nav class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <i class="fas fa-chalkboard-teacher text-green-600 text-xl mr-3"></i>
                        <h1 class="text-xl font-semibold text-gray-800">Dashboard Guru Wali</h1>
                    </div>
                    <button onclick="logout()" class="text-red-600 hover:text-red-800 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                    </button>
                </div>
            </div>
        </nav>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Filter Section -->
            <div class="bg-white rounded-xl card-shadow p-6 mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-filter text-blue-600 mr-3"></i>
                    Filter Data Jurnal
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Filter Kelas</label>
                        <select id="filterKelas" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Semua Kelas</option>
                            <option value="X">X</option>
                            <option value="XI">XI</option>
                            <option value="XII">XII</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Filter Jurusan</label>
                        <div class="space-y-2 max-h-32 overflow-y-auto border border-gray-300 rounded-lg p-2">
                            <label class="flex items-center">
                                <input type="checkbox" class="filter-jurusan mr-2" value="IPA"> IPA
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="filter-jurusan mr-2" value="IPS"> IPS
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="filter-jurusan mr-2" value="Bahasa"> Bahasa
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="filter-jurusan mr-2" value="Agama"> Agama
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Tanggal Input Jurnal</label>
                        <input type="date" id="filterTanggal" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Agama</label>
                        <select id="filterAgama" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="">Semua Agama</option>
                            <option value="Islam">Islam</option>
                            <option value="Kristen">Kristen</option>
                            <option value="Katolik">Katolik</option>
                            <option value="Hindu">Hindu</option>
                            <option value="Buddha">Buddha</option>
                            <option value="Konghucu">Konghucu</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="filterData()" class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200 flex items-center">
                    <i class="fas fa-search mr-2"></i>Filter Data
                </button>
            </div>

            <!-- Tabel Monitoring -->
            <div class="bg-white rounded-xl card-shadow p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-chart-line text-green-600 mr-3"></i>
                    Monitoring Jurnal 7 Kebiasaan Siswa
                </h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left">Nama Siswa</th>
                                <th class="px-4 py-2 text-left">Kelas</th>
                                <th class="px-4 py-2 text-left">Jurusan</th>
                                <th class="px-4 py-2 text-left">Agama</th>
                                <th class="px-4 py-2 text-left">Tanggal</th>
                                <th class="px-4 py-2 text-left">Bangun Pagi</th>
                                <th class="px-4 py-2 text-left">Beribadah</th>
                                <th class="px-4 py-2 text-left">Berolahraga</th>
                                <th class="px-4 py-2 text-left">Makan Sehat</th>
                                <th class="px-4 py-2 text-left">Gemar Belajar</th>
                                <th class="px-4 py-2 text-left">Bermasyarakat</th>
                                <th class="px-4 py-2 text-left">Tidur Cepat</th>
                            </tr>
                        </thead>
                        <tbody id="tabelMonitoring" class="divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Siswa Dashboard -->
    <div id="siswaDashboard" class="hidden">
        <nav class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <i class="fas fa-user-graduate text-blue-600 text-xl mr-3"></i>
                        <h1 class="text-xl font-semibold text-gray-800">Dashboard Siswa</h1>
                    </div>
                    <button onclick="logout()" class="text-red-600 hover:text-red-800 flex items-center">
                        <i class="fas fa-sign-out-alt mr-2"></i>Keluar
                    </button>
                </div>
            </div>
        </nav>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">Jurnal 7 Kebiasaan Anak Indonesia Hebat</h2>
                <p class="text-gray-600">Isi jurnal harianmu dengan jujur dan konsisten</p>
                <div class="mt-4 text-lg font-semibold text-blue-600" id="tanggalHari"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Card 1: Bangun Pagi -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card">
                    <div class="flex items-center mb-4">
                        <div class="bg-yellow-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-sun text-yellow-600 text-xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800">1. Bangun Pagi</h3>
                    </div>
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-gray-700">Waktu Bangun Pagi</label>
                        <input type="time" id="waktuBangun" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500">
                        <p class="text-xs text-gray-500">Catat waktu aktual saat bangun tidur</p>
                    </div>
                </div>

                <!-- Card 2: Beribadah -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card">
                    <div class="flex items-center mb-4">
                        <div class="bg-green-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-pray text-green-600 text-xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800">2. Beribadah</h3>
                    </div>
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-gray-700">Agama</label>
                        <select id="agamaSiswa" onchange="updateIbadahForm()" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                            <option value="">Pilih Agama</option>
                            <option value="Islam">Islam</option>
                            <option value="Kristen">Kristen</option>
                            <option value="Katolik">Katolik</option>
                            <option value="Hindu">Hindu</option>
                            <option value="Buddha">Buddha</option>
                            <option value="Konghucu">Konghucu</option>
                        </select>
                        <div id="formIbadah" class="space-y-2"></div>
                    </div>
                </div>

                <!-- Card 3: Berolahraga -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card">
                    <div class="flex items-center mb-4">
                        <div class="bg-red-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-running text-red-600 text-xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800">3. Berolahraga</h3>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Jenis Olahraga</label>
                            <input type="text" id="jenisOlahraga" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500" placeholder="Contoh: Lari, Push up, Sepak Bola, dll">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Durasi (menit)</label>
                            <input type="number" id="durasiOlahraga" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500" placeholder="30" min="1">
                        </div>
                    </div>
                </div>

                <!-- Card 4: Makan Sehat dan Bergizi -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card col-span-1 md:col-span-2 lg:col-span-3">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <div class="bg-orange-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                                <i class="fas fa-apple-alt text-orange-600 text-xl"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-800">4. Makan Sehat dan Bergizi</h3>
                        </div>
                        <button onclick="showDetailMakan('panduan')" class="bg-orange-100 text-orange-600 px-3 py-1 rounded-lg text-sm hover:bg-orange-200 transition duration-200">
                            Detail
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- Sarapan -->
                        <div class="border rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3 flex items-center">
                                🌅 Sarapan (06:00 - 09:00)
                            </h4>
                            <div class="space-y-2 text-sm">
                                <label class="flex items-center">
                                    <input type="checkbox" class="sarapan-check mr-2" value="karbohidrat"> Karbohidrat
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="sarapan-check mr-2" value="protein"> Protein
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="sarapan-check mr-2" value="sayuran"> Sayuran
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="sarapan-check mr-2" value="buah"> Buah
                                </label>
                            </div>
                        </div>

                        <!-- Makan Siang -->
                        <div class="border rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3 flex items-center">
                                ☀️ Makan Siang (12:00 - 14:00)
                            </h4>
                            <div class="space-y-2 text-sm">
                                <label class="flex items-center">
                                    <input type="checkbox" class="siang-check mr-2" value="karbohidrat"> Karbohidrat
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="siang-check mr-2" value="protein"> Protein
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="siang-check mr-2" value="sayuran"> Sayuran
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="siang-check mr-2" value="buah"> Buah
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="siang-check mr-2" value="minuman"> Minuman Sehat
                                </label>
                            </div>
                        </div>

                        <!-- Makan Malam -->
                        <div class="border rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3 flex items-center">
                                🌙 Makan Malam (18:00 - 20:00)
                            </h4>
                            <div class="space-y-2 text-sm">
                                <label class="flex items-center">
                                    <input type="checkbox" class="malam-check mr-2" value="karbohidrat"> Karbohidrat
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="malam-check mr-2" value="protein"> Protein
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="malam-check mr-2" value="sayuran"> Sayuran
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="malam-check mr-2" value="buah"> Buah
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" class="malam-check mr-2" value="minuman"> Minuman Sehat
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Card 5: Gemar Belajar -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card">
                    <div class="flex items-center mb-4">
                        <div class="bg-purple-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-book text-purple-600 text-xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800">5. Gemar Belajar</h3>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Kegiatan Belajar di Luar Sekolah</label>
                            <textarea id="kegiatanBelajar" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" rows="4" placeholder="Contoh: Belajar Kelompok Membahas PR Matematika, Membaca buku sejarah, Mengerjakan soal fisika, dll"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Card 6: Bermasyarakat -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card">
                    <div class="flex items-center mb-4">
                        <div class="bg-indigo-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-users text-indigo-600 text-xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800">6. Bermasyarakat</h3>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-gray-700">Kegiatan Bermasyarakat</label>
                            <textarea id="kegiatanMasyarakat" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" rows="4" placeholder="Contoh: Mengikuti Kegiatan Siskamling, Gotong Royong Membersihkan Selokan, Membantu tetangga, dll"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Card 7: Tidur Cepat -->
                <div class="bg-white rounded-xl card-shadow p-6 habit-card">
                    <div class="flex items-center mb-4">
                        <div class="bg-blue-100 w-12 h-12 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-moon text-blue-600 text-xl"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-800">7. Tidur Cepat</h3>
                    </div>
                    <div class="space-y-3">
                        <label class="block text-sm font-medium text-gray-700">Waktu Tidur Malam</label>
                        <input type="time" id="waktuTidur" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                        <p class="text-xs text-gray-500">Catat waktu aktual saat mulai tidur</p>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="mt-8 text-center">
                <button onclick="simpanJurnal()" class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-lg hover:from-blue-700 hover:to-purple-700 transition duration-200 font-medium text-lg">
                    <i class="fas fa-save mr-2"></i>Simpan Jurnal Hari Ini
                </button>
            </div>

            <!-- Riwayat Jurnal Saya -->
            <div class="mt-8 bg-white rounded-xl card-shadow p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-history text-green-600 mr-3"></i>
                    Riwayat Jurnal Saya
                </h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left">Tanggal</th>
                                <th class="px-4 py-2 text-left">Bangun Pagi</th>
                                <th class="px-4 py-2 text-left">Beribadah</th>
                                <th class="px-4 py-2 text-left">Berolahraga</th>
                                <th class="px-4 py-2 text-left">Status</th>
                                <th class="px-4 py-2 text-left">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="tabelRiwayatJurnal" class="divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detail Makan -->
    <div id="modalDetailMakan" class="hidden fixed inset-0 bg-black bg-opacity-50 modal-overlay flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-lg font-semibold text-gray-800">Panduan Makan Sehat dan Bergizi</h3>
                <button onclick="closeDetailMakan()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modalContent" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-yellow-800 mb-2">🌅 Pagi hari (06:00 - 09:00)</h4>
                        <p class="text-sm text-yellow-700">Saya Makan Nasi, Lauk Ikan Gurame Bakar, Sayur Sop, Buah Naga, dan Minum Susu</p>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-orange-800 mb-2">☀️ Siang hari (12:00 - 14:00)</h4>
                        <p class="text-sm text-orange-700">Saya Makan Nasi, Lauk Ikan Gurame Bakar, Sayur Sop, Buah Naga, dan Minum Susu</p>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-blue-800 mb-2">🌙 Malam Hari (18:00 - 20:00)</h4>
                        <p class="text-sm text-blue-700">Saya Makan Buah Pisang</p>
                    </div>
                </div>
            </div>
            <div class="mt-6 p-4 bg-green-50 rounded-lg">
                <h4 class="font-medium text-green-800 mb-2">🥗 Tips Makan Sehat:</h4>
                <ul class="text-sm text-green-700 space-y-1">
                    <li>• Makan dengan porsi seimbang sesuai kebutuhan</li>
                    <li>• Perbanyak konsumsi sayur dan buah segar</li>
                    <li>• Minum air putih minimal 8 gelas per hari</li>
                    <li>• Hindari makanan berlemak berlebih dan junk food</li>
                    <li>• Makan tepat waktu dan jangan melewatkan sarapan</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Modal Edit Guru -->
    <div id="modalEditGuru" class="hidden fixed inset-0 bg-black bg-opacity-50 modal-overlay flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Edit Data Guru</h3>
                <button onclick="closeEditGuru()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Guru</label>
                    <input type="text" id="editNamaGuru" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Jabatan Guru</label>
                    <input type="text" id="editJabatanGuru" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Jurusan</label>
                    <div class="grid grid-cols-2 gap-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="edit-jurusan-guru mr-2" value="IPA"> IPA
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="edit-jurusan-guru mr-2" value="IPS"> IPS
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="edit-jurusan-guru mr-2" value="Bahasa"> Bahasa
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="edit-jurusan-guru mr-2" value="Agama"> Agama
                        </label>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button onclick="simpanEditGuru()" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">
                        Simpan
                    </button>
                    <button onclick="closeEditGuru()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700">
                        Batal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Edit Siswa -->
    <div id="modalEditSiswa" class="hidden fixed inset-0 bg-black bg-opacity-50 modal-overlay flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Edit Data Siswa</h3>
                <button onclick="closeEditSiswa()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Siswa</label>
                    <input type="text" id="editNamaSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kelas</label>
                    <select id="editKelasSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="X">X</option>
                        <option value="XI">XI</option>
                        <option value="XII">XII</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Jurusan</label>
                    <select id="editJurusanSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="IPA">IPA</option>
                        <option value="IPS">IPS</option>
                        <option value="Bahasa">Bahasa</option>
                        <option value="Agama">Agama</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Agama</label>
                    <select id="editAgamaSiswa" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                        <option value="Islam">Islam</option>
                        <option value="Kristen">Kristen</option>
                        <option value="Katolik">Katolik</option>
                        <option value="Hindu">Hindu</option>
                        <option value="Buddha">Buddha</option>
                        <option value="Konghucu">Konghucu</option>
                    </select>
                </div>
                <div class="flex gap-2 pt-4">
                    <button onclick="simpanEditSiswa()" class="flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700">
                        Simpan
                    </button>
                    <button onclick="closeEditSiswa()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700">
                        Batal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detail Jurnal -->
    <div id="modalDetailJurnal" class="hidden fixed inset-0 bg-black bg-opacity-50 modal-overlay flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-96 overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Detail Jurnal Harian</h3>
                <div class="flex gap-2">
                    <button onclick="cetakPDF()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 text-sm">
                        <i class="fas fa-file-pdf mr-2"></i>Cetak PDF
                    </button>
                    <button onclick="closeDetailJurnal()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div id="detailJurnalContent" class="space-y-4">
                <!-- Content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modal Tambah Jurusan -->
    <div id="modalTambahJurusan" class="hidden fixed inset-0 bg-black bg-opacity-50 modal-overlay flex items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Tambah Jurusan Baru</h3>
                <button onclick="closeTambahJurusan()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Kode Jurusan</label>
                    <input type="text" id="kodeJurusan" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="Contoh: IPA">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Nama Jurusan</label>
                    <input type="text" id="namaJurusan" class="w-full px-3 py-2 border border-gray-300 rounded-lg" placeholder="Contoh: Ilmu Pengetahuan Alam">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="deskripsiJurusan" class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="3" placeholder="Deskripsi singkat tentang jurusan"></textarea>
                </div>
                <div class="flex gap-2 pt-4">
                    <button onclick="simpanJurusan()" class="flex-1 bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700">
                        Simpan
                    </button>
                    <button onclick="closeTambahJurusan()" class="flex-1 bg-gray-600 text-white py-2 rounded-lg hover:bg-gray-700">
                        Batal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let dataGuru = [];
        let dataSiswa = [];
        let dataJurnal = [];
        let dataPenautkan = [];
        let dataJurusan = [];
        let currentUser = null;
        let editingGuruId = null;
        let editingSiswaId = null;
        let currentJurnalDetail = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateTanggalHari();
            loadSampleData();
        });

        function updateTanggalHari() {
            const today = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            document.getElementById('tanggalHari').textContent = today.toLocaleDateString('id-ID', options);
        }

        function loadSampleData() {
            // Sample data jurusan
            dataJurusan = [
                { id: 1, kode: 'IPA', nama: 'Ilmu Pengetahuan Alam', deskripsi: 'Jurusan yang mempelajari matematika, fisika, kimia, dan biologi' },
                { id: 2, kode: 'IPS', nama: 'Ilmu Pengetahuan Sosial', deskripsi: 'Jurusan yang mempelajari sejarah, geografi, ekonomi, dan sosiologi' },
                { id: 3, kode: 'Bahasa', nama: 'Bahasa dan Sastra', deskripsi: 'Jurusan yang mempelajari bahasa Indonesia, bahasa Inggris, dan sastra' },
                { id: 4, kode: 'Agama', nama: 'Pendidikan Agama', deskripsi: 'Jurusan yang mempelajari ilmu agama dan akhlak' }
            ];

            // Sample data guru
            dataGuru = [
                { id: 1, nama: 'Budi Santoso, S.Pd', jabatan: 'Guru Wali Kelas', jurusan: ['IPA', 'Bahasa'] },
                { id: 2, nama: 'Siti Nurhaliza, S.Pd', jabatan: 'Guru Wali Kelas', jurusan: ['IPS'] },
                { id: 3, nama: 'Ahmad Fauzi, S.Ag', jabatan: 'Guru Wali Kelas', jurusan: ['Agama'] }
            ];

            // Sample data siswa
            dataSiswa = [
                { id: 1, nama: 'Andi Pratama', kelas: 'XI', jurusan: 'IPA', agama: 'Islam' },
                { id: 2, nama: 'Sari Dewi', kelas: 'XI', jurusan: 'IPS', agama: 'Kristen' },
                { id: 3, nama: 'Budi Setiawan', kelas: 'XII', jurusan: 'Bahasa', agama: 'Islam' },
                { id: 4, nama: 'Maya Sari', kelas: 'X', jurusan: 'IPA', agama: 'Hindu' }
            ];

            // Sample data jurnal
            dataJurnal = [
                {
                    siswaId: 1,
                    nama: 'Andi Pratama',
                    kelas: 'XI',
                    jurusan: 'IPA',
                    agama: 'Islam',
                    tanggal: '2024-01-15',
                    bangunPagi: '05:30',
                    beribadah: 'Sholat 5 waktu + Dhuha',
                    berolahraga: 'Lari 30 menit',
                    makanSehat: 'Sarapan: 4/4, Siang: 5/5, Malam: 3/5',
                    gemarBelajar: 'Belajar Matematika dan mengerjakan PR Fisika',
                    bermasyarakat: 'Membantu tetangga membersihkan halaman',
                    tidurCepat: '21:00'
                },
                {
                    siswaId: 2,
                    nama: 'Sari Dewi',
                    kelas: 'XI',
                    jurusan: 'IPS',
                    agama: 'Kristen',
                    tanggal: '2024-01-15',
                    bangunPagi: '06:00',
                    beribadah: 'Doa pagi dan membaca Alkitab',
                    berolahraga: 'Senam aerobik 45 menit',
                    makanSehat: 'Sarapan: 3/4, Siang: 4/5, Malam: 4/5',
                    gemarBelajar: 'Belajar kelompok membahas sejarah Indonesia',
                    bermasyarakat: 'Mengikuti kegiatan karang taruna',
                    tidurCepat: '22:00'
                }
            ];

            updateTabelJurusan();
            updateTabelGuru();
            updateTabelSiswa();
            updateTabelMonitoring();
            updateTabelMapping();
            updatePilihGuru();
            updateDaftarSiswa();
            updateRiwayatJurnal();
        }

        // Login functionality
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const role = document.getElementById('role').value;

            if (!username || !password || !role) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            // Simple authentication (in real app, this would be server-side)
            if (password === '123456') {
                currentUser = { username, role };
                showDashboard(role);
            } else {
                alert('Password salah! Gunakan: 123456');
            }
        });

        function showDashboard(role) {
            document.getElementById('loginPage').classList.add('hidden');
            
            if (role === 'admin') {
                document.getElementById('adminDashboard').classList.remove('hidden');
            } else if (role === 'guru') {
                document.getElementById('guruDashboard').classList.remove('hidden');
            } else if (role === 'siswa') {
                document.getElementById('siswaDashboard').classList.remove('hidden');
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('guruDashboard').classList.add('hidden');
            document.getElementById('siswaDashboard').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
            
            // Reset form
            document.getElementById('loginForm').reset();
        }

        // Admin functions
        function tambahGuru() {
            const nama = document.getElementById('namaGuru').value;
            const jabatan = document.getElementById('jabatanGuru').value;
            const jurusanChecked = Array.from(document.querySelectorAll('.jurusan-guru:checked')).map(cb => cb.value);

            if (!nama || !jabatan || jurusanChecked.length === 0) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            const newId = dataGuru.length > 0 ? Math.max(...dataGuru.map(g => g.id)) + 1 : 1;
            dataGuru.push({
                id: newId,
                nama: nama,
                jabatan: jabatan,
                jurusan: jurusanChecked
            });

            // Reset form
            document.getElementById('namaGuru').value = '';
            document.getElementById('jabatanGuru').value = '';
            document.querySelectorAll('.jurusan-guru').forEach(cb => cb.checked = false);

            updateTabelGuru();
            updatePilihGuru();
            alert('Data guru berhasil ditambahkan!');
        }

        function tambahSiswa() {
            const nama = document.getElementById('namaSiswa').value;
            const kelas = document.getElementById('kelasSiswa').value;
            const jurusan = document.getElementById('jurusanSiswa').value;
            const agama = document.getElementById('agamaSiswaAdmin').value;

            if (!nama || !kelas || !jurusan || !agama) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            const newId = dataSiswa.length > 0 ? Math.max(...dataSiswa.map(s => s.id)) + 1 : 1;
            dataSiswa.push({
                id: newId,
                nama: nama,
                kelas: kelas,
                jurusan: jurusan,
                agama: agama
            });

            // Reset form
            document.getElementById('namaSiswa').value = '';
            document.getElementById('kelasSiswa').value = '';
            document.getElementById('jurusanSiswa').value = '';
            document.getElementById('agamaSiswaAdmin').value = '';

            updateTabelSiswa();
            updateDaftarSiswa();
            alert('Data siswa berhasil ditambahkan!');
        }

        function downloadTemplateGuru() {
            // Create Excel-like structure using HTML table
            const excelContent = `
                <table>
                    <tr>
                        <th>Nama Guru</th>
                        <th>Jabatan Guru</th>
                        <th>Jurusan (pisahkan dengan ;)</th>
                    </tr>
                    <tr>
                        <td>Budi Santoso, S.Pd</td>
                        <td>Guru Wali Kelas</td>
                        <td>IPA;Bahasa</td>
                    </tr>
                    <tr>
                        <td>Siti Nurhaliza, S.Pd</td>
                        <td>Guru Wali Kelas</td>
                        <td>IPS</td>
                    </tr>
                    <tr>
                        <td>Ahmad Fauzi, S.Ag</td>
                        <td>Guru Wali Kelas</td>
                        <td>Agama</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
            `;
            
            const blob = new Blob([excelContent], { type: 'application/vnd.ms-excel' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Template_Data_Guru.xls';
            a.click();
            window.URL.revokeObjectURL(url);
            
            alert('Template Excel untuk Data Guru berhasil didownload! Silakan isi data guru sesuai format yang disediakan.');
        }

        function downloadTemplateSiswa() {
            // Create Excel-like structure using HTML table
            const excelContent = `
                <table>
                    <tr>
                        <th>Nama Siswa</th>
                        <th>Kelas</th>
                        <th>Jurusan</th>
                        <th>Agama</th>
                    </tr>
                    <tr>
                        <td>Andi Pratama</td>
                        <td>XI</td>
                        <td>IPA</td>
                        <td>Islam</td>
                    </tr>
                    <tr>
                        <td>Sari Dewi</td>
                        <td>XI</td>
                        <td>IPS</td>
                        <td>Kristen</td>
                    </tr>
                    <tr>
                        <td>Budi Setiawan</td>
                        <td>XII</td>
                        <td>Bahasa</td>
                        <td>Islam</td>
                    </tr>
                    <tr>
                        <td>Maya Sari</td>
                        <td>X</td>
                        <td>IPA</td>
                        <td>Hindu</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
            `;
            
            const blob = new Blob([excelContent], { type: 'application/vnd.ms-excel' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Template_Data_Siswa.xls';
            a.click();
            window.URL.revokeObjectURL(url);
            
            alert('Template Excel untuk Data Siswa berhasil didownload! Silakan isi data siswa sesuai format yang disediakan.');
        }

        function uploadGuru() {
            const fileInput = document.getElementById('fileGuru');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Pilih file Excel (.xls/.xlsx) terlebih dahulu!');
                return;
            }

            // Validate file type
            const allowedTypes = [
                'application/vnd.ms-excel',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
            ];
            
            if (!allowedTypes.includes(file.type) && !file.name.match(/\.(xls|xlsx)$/i)) {
                alert('Format file tidak valid! Gunakan file Excel (.xls atau .xlsx)');
                return;
            }

            // Simulate file processing
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // In a real application, you would use a library like SheetJS to parse Excel
                    // For demo purposes, we'll simulate successful upload
                    
                    // Add sample data as if it was read from Excel
                    const sampleDataFromExcel = [
                        { nama: 'Dr. Sari Indah, M.Pd', jabatan: 'Kepala Sekolah', jurusan: ['IPA', 'IPS'] },
                        { nama: 'Rahmat Hidayat, S.Pd', jabatan: 'Guru Wali Kelas', jurusan: ['Bahasa'] },
                        { nama: 'Dewi Kartika, S.Ag', jabatan: 'Guru Wali Kelas', jurusan: ['Agama'] }
                    ];
                    
                    // Add to existing data
                    sampleDataFromExcel.forEach(guru => {
                        const newId = dataGuru.length > 0 ? Math.max(...dataGuru.map(g => g.id)) + 1 : 1;
                        dataGuru.push({
                            id: newId,
                            nama: guru.nama,
                            jabatan: guru.jabatan,
                            jurusan: guru.jurusan
                        });
                    });
                    
                    updateTabelGuru();
                    updatePilihGuru();
                    
                    alert(`✅ File Excel berhasil diupload!\n${sampleDataFromExcel.length} data guru baru telah ditambahkan ke sistem.`);
                    
                    // Reset file input
                    fileInput.value = '';
                    
                } catch (error) {
                    alert('❌ Terjadi kesalahan saat memproses file Excel. Pastikan format file sesuai dengan template yang disediakan.');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        function uploadSiswa() {
            const fileInput = document.getElementById('fileSiswa');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Pilih file Excel (.xls/.xlsx) terlebih dahulu!');
                return;
            }

            // Validate file type
            const allowedTypes = [
                'application/vnd.ms-excel',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
            ];
            
            if (!allowedTypes.includes(file.type) && !file.name.match(/\.(xls|xlsx)$/i)) {
                alert('Format file tidak valid! Gunakan file Excel (.xls atau .xlsx)');
                return;
            }

            // Simulate file processing
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // In a real application, you would use a library like SheetJS to parse Excel
                    // For demo purposes, we'll simulate successful upload
                    
                    // Add sample data as if it was read from Excel
                    const sampleDataFromExcel = [
                        { nama: 'Rizki Pratama', kelas: 'X', jurusan: 'IPA', agama: 'Islam' },
                        { nama: 'Indah Permata', kelas: 'XI', jurusan: 'IPS', agama: 'Kristen' },
                        { nama: 'Fajar Nugroho', kelas: 'XII', jurusan: 'Bahasa', agama: 'Islam' },
                        { nama: 'Sinta Dewi', kelas: 'X', jurusan: 'Agama', agama: 'Hindu' },
                        { nama: 'Bayu Setiawan', kelas: 'XI', jurusan: 'IPA', agama: 'Buddha' }
                    ];
                    
                    // Add to existing data
                    sampleDataFromExcel.forEach(siswa => {
                        const newId = dataSiswa.length > 0 ? Math.max(...dataSiswa.map(s => s.id)) + 1 : 1;
                        dataSiswa.push({
                            id: newId,
                            nama: siswa.nama,
                            kelas: siswa.kelas,
                            jurusan: siswa.jurusan,
                            agama: siswa.agama
                        });
                    });
                    
                    updateTabelSiswa();
                    updateDaftarSiswa();
                    
                    alert(`✅ File Excel berhasil diupload!\n${sampleDataFromExcel.length} data siswa baru telah ditambahkan ke sistem.`);
                    
                    // Reset file input
                    fileInput.value = '';
                    
                } catch (error) {
                    alert('❌ Terjadi kesalahan saat memproses file Excel. Pastikan format file sesuai dengan template yang disediakan.');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        function updatePilihGuru() {
            const select = document.getElementById('pilihGuru');
            select.innerHTML = '<option value="">Pilih Guru Wali</option>';
            
            dataGuru.forEach(guru => {
                const option = document.createElement('option');
                option.value = guru.id;
                option.textContent = `${guru.nama} (${guru.jurusan.join(', ')})`;
                select.appendChild(option);
            });
        }

        function updateDaftarSiswa() {
            const container = document.getElementById('daftarSiswa');
            const filterJurusan = document.getElementById('filterJurusanSiswa').value;
            container.innerHTML = '';
            
            let filteredSiswa = dataSiswa;
            if (filterJurusan) {
                filteredSiswa = dataSiswa.filter(siswa => siswa.jurusan === filterJurusan);
            }
            
            if (filteredSiswa.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">Tidak ada siswa sesuai filter</p>';
                return;
            }
            
            filteredSiswa.forEach(siswa => {
                const div = document.createElement('div');
                div.className = 'flex items-center mb-2';
                div.innerHTML = `
                    <input type="checkbox" class="siswa-pilih mr-2" value="${siswa.id}">
                    <span class="text-sm">${siswa.nama} (${siswa.kelas} ${siswa.jurusan})</span>
                `;
                container.appendChild(div);
            });
        }

        // Jurusan functions
        function showTambahJurusan() {
            document.getElementById('modalTambahJurusan').classList.remove('hidden');
        }

        function closeTambahJurusan() {
            document.getElementById('modalTambahJurusan').classList.add('hidden');
            document.getElementById('kodeJurusan').value = '';
            document.getElementById('namaJurusan').value = '';
            document.getElementById('deskripsiJurusan').value = '';
        }

        function simpanJurusan() {
            const kode = document.getElementById('kodeJurusan').value;
            const nama = document.getElementById('namaJurusan').value;
            const deskripsi = document.getElementById('deskripsiJurusan').value;

            if (!kode || !nama || !deskripsi) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            const newId = dataJurusan.length > 0 ? Math.max(...dataJurusan.map(j => j.id)) + 1 : 1;
            dataJurusan.push({
                id: newId,
                kode: kode,
                nama: nama,
                deskripsi: deskripsi
            });

            updateTabelJurusan();
            closeTambahJurusan();
            alert('Data jurusan berhasil ditambahkan!');
        }

        function downloadTemplateJurusan() {
            const excelContent = `
                <table>
                    <tr>
                        <th>Kode Jurusan</th>
                        <th>Nama Jurusan</th>
                        <th>Deskripsi</th>
                    </tr>
                    <tr>
                        <td>IPA</td>
                        <td>Ilmu Pengetahuan Alam</td>
                        <td>Jurusan yang mempelajari matematika, fisika, kimia, dan biologi</td>
                    </tr>
                    <tr>
                        <td>IPS</td>
                        <td>Ilmu Pengetahuan Sosial</td>
                        <td>Jurusan yang mempelajari sejarah, geografi, ekonomi, dan sosiologi</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
            `;
            
            const blob = new Blob([excelContent], { type: 'application/vnd.ms-excel' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Template_Data_Jurusan.xls';
            a.click();
            window.URL.revokeObjectURL(url);
            
            alert('Template Excel untuk Data Jurusan berhasil didownload!');
        }

        function editJurusan(id) {
            const jurusan = dataJurusan.find(j => j.id === id);
            if (!jurusan) return;

            const kode = prompt('Edit Kode Jurusan:', jurusan.kode);
            const nama = prompt('Edit Nama Jurusan:', jurusan.nama);
            const deskripsi = prompt('Edit Deskripsi:', jurusan.deskripsi);

            if (kode && nama && deskripsi) {
                jurusan.kode = kode;
                jurusan.nama = nama;
                jurusan.deskripsi = deskripsi;
                updateTabelJurusan();
                alert('Data jurusan berhasil diperbarui!');
            }
        }

        function hapusJurusan(id) {
            if (confirm('Apakah Anda yakin menghapus data jurusan ini?')) {
                dataJurusan = dataJurusan.filter(j => j.id !== id);
                updateTabelJurusan();
                alert('Data jurusan berhasil dihapus!');
            }
        }

        function updateTabelJurusan() {
            const tbody = document.getElementById('tabelJurusan');
            tbody.innerHTML = '';

            dataJurusan.forEach(jurusan => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${jurusan.kode}</td>
                    <td class="px-4 py-2">${jurusan.nama}</td>
                    <td class="px-4 py-2">${jurusan.deskripsi}</td>
                    <td class="px-4 py-2">
                        <div class="flex gap-2">
                            <button onclick="editJurusan(${jurusan.id})" class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="hapusJurusan(${jurusan.id})" class="bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Edit Guru functions
        function editGuru(id) {
            const guru = dataGuru.find(g => g.id === id);
            if (!guru) return;

            editingGuruId = id;
            document.getElementById('editNamaGuru').value = guru.nama;
            document.getElementById('editJabatanGuru').value = guru.jabatan;
            
            // Reset checkboxes
            document.querySelectorAll('.edit-jurusan-guru').forEach(cb => cb.checked = false);
            
            // Set checked jurusan
            guru.jurusan.forEach(j => {
                const checkbox = document.querySelector(`.edit-jurusan-guru[value="${j}"]`);
                if (checkbox) checkbox.checked = true;
            });

            document.getElementById('modalEditGuru').classList.remove('hidden');
        }

        function closeEditGuru() {
            document.getElementById('modalEditGuru').classList.add('hidden');
            editingGuruId = null;
        }

        function simpanEditGuru() {
            const nama = document.getElementById('editNamaGuru').value;
            const jabatan = document.getElementById('editJabatanGuru').value;
            const jurusanChecked = Array.from(document.querySelectorAll('.edit-jurusan-guru:checked')).map(cb => cb.value);

            if (!nama || !jabatan || jurusanChecked.length === 0) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            const guru = dataGuru.find(g => g.id === editingGuruId);
            if (guru) {
                guru.nama = nama;
                guru.jabatan = jabatan;
                guru.jurusan = jurusanChecked;
                
                updateTabelGuru();
                updatePilihGuru();
                closeEditGuru();
                alert('Data guru berhasil diperbarui!');
            }
        }

        function hapusGuru(id) {
            if (confirm('Apakah Anda yakin menghapus data guru ini?')) {
                dataGuru = dataGuru.filter(g => g.id !== id);
                updateTabelGuru();
                updatePilihGuru();
                alert('Data guru berhasil dihapus!');
            }
        }

        // Edit Siswa functions
        function editSiswa(id) {
            const siswa = dataSiswa.find(s => s.id === id);
            if (!siswa) return;

            editingSiswaId = id;
            document.getElementById('editNamaSiswa').value = siswa.nama;
            document.getElementById('editKelasSiswa').value = siswa.kelas;
            document.getElementById('editJurusanSiswa').value = siswa.jurusan;
            document.getElementById('editAgamaSiswa').value = siswa.agama;

            document.getElementById('modalEditSiswa').classList.remove('hidden');
        }

        function closeEditSiswa() {
            document.getElementById('modalEditSiswa').classList.add('hidden');
            editingSiswaId = null;
        }

        function simpanEditSiswa() {
            const nama = document.getElementById('editNamaSiswa').value;
            const kelas = document.getElementById('editKelasSiswa').value;
            const jurusan = document.getElementById('editJurusanSiswa').value;
            const agama = document.getElementById('editAgamaSiswa').value;

            if (!nama || !kelas || !jurusan || !agama) {
                alert('Mohon lengkapi semua field!');
                return;
            }

            const siswa = dataSiswa.find(s => s.id === editingSiswaId);
            if (siswa) {
                siswa.nama = nama;
                siswa.kelas = kelas;
                siswa.jurusan = jurusan;
                siswa.agama = agama;
                
                updateTabelSiswa();
                updateDaftarSiswa();
                closeEditSiswa();
                alert('Data siswa berhasil diperbarui!');
            }
        }

        function hapusSiswa(id) {
            if (confirm('Apakah Anda yakin menghapus data siswa ini?')) {
                dataSiswa = dataSiswa.filter(s => s.id !== id);
                updateTabelSiswa();
                updateDaftarSiswa();
                alert('Data siswa berhasil dihapus!');
            }
        }

        // Mapping functions
        function updateTabelMapping() {
            const tbody = document.getElementById('tabelMapping');
            tbody.innerHTML = '';

            dataPenautkan.forEach((mapping, index) => {
                const guru = dataGuru.find(g => g.id === mapping.guruId);
                const siswaList = mapping.siswaIds.map(id => {
                    const siswa = dataSiswa.find(s => s.id === id);
                    return siswa ? siswa.nama : 'Unknown';
                }).join(', ');

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${guru ? guru.nama : 'Unknown'}</td>
                    <td class="px-4 py-2">${guru ? guru.jurusan.join(', ') : '-'}</td>
                    <td class="px-4 py-2">${siswaList}</td>
                    <td class="px-4 py-2">${mapping.siswaIds.length} siswa</td>
                    <td class="px-4 py-2">
                        <div class="flex gap-2">
                            <button onclick="editMapping(${index})" class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="hapusMapping(${index})" class="bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function editMapping(index) {
            const mapping = dataPenautkan[index];
            if (!mapping) return;

            // Set guru selection
            document.getElementById('pilihGuru').value = mapping.guruId;
            
            // Set siswa selections
            document.querySelectorAll('.siswa-pilih').forEach(cb => {
                cb.checked = mapping.siswaIds.includes(parseInt(cb.value));
            });

            // Remove current mapping temporarily for editing
            dataPenautkan.splice(index, 1);
            updateTabelMapping();
            
            alert('Data mapping telah dimuat untuk diedit. Silakan ubah dan klik "Tautkan Guru dengan Siswa" untuk menyimpan.');
        }

        function hapusMapping(index) {
            if (confirm('Apakah Anda yakin menghapus mapping guru-siswa ini?')) {
                dataPenautkan.splice(index, 1);
                updateTabelMapping();
                alert('Mapping guru-siswa berhasil dihapus!');
            }
        }

        function tautkanGuruSiswa() {
            const guruId = document.getElementById('pilihGuru').value;
            const siswaIds = Array.from(document.querySelectorAll('.siswa-pilih:checked')).map(cb => parseInt(cb.value));
            
            if (!guruId || siswaIds.length === 0) {
                alert('Pilih guru dan minimal satu siswa!');
                return;
            }
            
            // Save penautkan data
            dataPenautkan.push({
                guruId: parseInt(guruId),
                siswaIds: siswaIds,
                tanggal: new Date().toISOString().split('T')[0]
            });
            
            // Reset selections
            document.getElementById('pilihGuru').value = '';
            document.querySelectorAll('.siswa-pilih').forEach(cb => cb.checked = false);
            
            alert('Guru wali berhasil ditautkan dengan siswa yang dipilih!');
        }

        function updateTabelGuru() {
            const tbody = document.getElementById('tabelGuru');
            tbody.innerHTML = '';

            dataGuru.forEach(guru => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${guru.nama}</td>
                    <td class="px-4 py-2">${guru.jabatan}</td>
                    <td class="px-4 py-2">${guru.jurusan.join(', ')}</td>
                    <td class="px-4 py-2">
                        <div class="flex gap-2">
                            <button onclick="editGuru(${guru.id})" class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="hapusGuru(${guru.id})" class="bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateTabelSiswa() {
            const tbody = document.getElementById('tabelSiswa');
            tbody.innerHTML = '';

            dataSiswa.forEach(siswa => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${siswa.nama}</td>
                    <td class="px-4 py-2">${siswa.kelas}</td>
                    <td class="px-4 py-2">${siswa.jurusan}</td>
                    <td class="px-4 py-2">${siswa.agama}</td>
                    <td class="px-4 py-2">
                        <div class="flex gap-2">
                            <button onclick="editSiswa(${siswa.id})" class="bg-blue-500 text-white px-2 py-1 rounded text-xs hover:bg-blue-600">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="hapusSiswa(${siswa.id})" class="bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Guru functions
        function filterData() {
            updateTabelMonitoring();
            alert('Data berhasil difilter sesuai kriteria yang dipilih!');
        }

        function updateTabelMonitoring() {
            const tbody = document.getElementById('tabelMonitoring');
            tbody.innerHTML = '';

            // Get filter values
            const filterKelas = document.getElementById('filterKelas').value;
            const filterTanggal = document.getElementById('filterTanggal').value;
            const filterAgama = document.getElementById('filterAgama').value;
            const filterJurusan = Array.from(document.querySelectorAll('.filter-jurusan:checked')).map(cb => cb.value);

            let filteredData = dataJurnal;

            // Apply filters
            if (filterKelas) {
                filteredData = filteredData.filter(item => item.kelas === filterKelas);
            }
            if (filterTanggal) {
                filteredData = filteredData.filter(item => item.tanggal === filterTanggal);
            }
            if (filterAgama) {
                filteredData = filteredData.filter(item => item.agama === filterAgama);
            }
            if (filterJurusan.length > 0) {
                filteredData = filteredData.filter(item => filterJurusan.includes(item.jurusan));
            }

            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="12" class="px-4 py-8 text-center text-gray-500">Tidak ada data jurnal yang sesuai dengan filter</td></tr>';
                return;
            }

            filteredData.forEach(jurnal => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${jurnal.nama}</td>
                    <td class="px-4 py-2">${jurnal.kelas}</td>
                    <td class="px-4 py-2">${jurnal.jurusan}</td>
                    <td class="px-4 py-2">${jurnal.agama}</td>
                    <td class="px-4 py-2">${jurnal.tanggal}</td>
                    <td class="px-4 py-2">${jurnal.bangunPagi}</td>
                    <td class="px-4 py-2">${jurnal.beribadah}</td>
                    <td class="px-4 py-2">${jurnal.berolahraga}</td>
                    <td class="px-4 py-2">${jurnal.makanSehat}</td>
                    <td class="px-4 py-2">${jurnal.gemarBelajar}</td>
                    <td class="px-4 py-2">${jurnal.bermasyarakat}</td>
                    <td class="px-4 py-2">${jurnal.tidurCepat}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Siswa functions
        function updateIbadahForm() {
            const agama = document.getElementById('agamaSiswa').value;
            const formIbadah = document.getElementById('formIbadah');
            
            formIbadah.innerHTML = '';

            if (agama === 'Islam') {
                formIbadah.innerHTML = `
                    <div class="space-y-3">
                        <h4 class="font-medium text-gray-700">Sholat Wajib:</h4>
                        <div class="grid grid-cols-1 gap-2 text-sm">
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="subuh"> Subuh (04:30-06:00)
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="dzuhur"> Dzuhur/Jumat (11:30-15:00)
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="ashar"> Ashar (15:00-18:00)
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="maghrib"> Maghrib (18:00-19:30)
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="isya"> Isya (19:30-04:00)
                            </label>
                        </div>
                        <h4 class="font-medium text-gray-700 mt-3">Sholat Sunnah:</h4>
                        <div class="space-y-1 text-sm">
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="rawatib"> Shalat Rawatib
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="dhuha"> Shalat Dhuha
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="ibadah-check mr-2" value="tahajud"> Shalat Tahajud
                            </label>
                        </div>
                    </div>
                `;
            } else if (agama) {
                formIbadah.innerHTML = `
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Kegiatan Ibadah</label>
                        <textarea id="ibadahLainnya" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" rows="3" placeholder="Tuliskan kegiatan ibadah yang dilakukan sesuai agama dan keyakinan"></textarea>
                    </div>
                `;
            }
        }

        function showDetailMakan(waktu) {
            const modal = document.getElementById('modalDetailMakan');
            modal.classList.remove('hidden');
        }

        function closeDetailMakan() {
            document.getElementById('modalDetailMakan').classList.add('hidden');
        }

        function simpanJurnal() {
            // Collect all form data
            const waktuBangun = document.getElementById('waktuBangun').value;
            const agama = document.getElementById('agamaSiswa').value;
            const jenisOlahraga = document.getElementById('jenisOlahraga').value;
            const durasiOlahraga = document.getElementById('durasiOlahraga').value;
            const kegiatanBelajar = document.getElementById('kegiatanBelajar').value;
            const kegiatanMasyarakat = document.getElementById('kegiatanMasyarakat').value;
            const waktuTidur = document.getElementById('waktuTidur').value;

            // Check required fields
            if (!waktuBangun || !agama || !jenisOlahraga || !durasiOlahraga || !kegiatanBelajar || !kegiatanMasyarakat || !waktuTidur) {
                alert('Mohon lengkapi semua field jurnal!');
                return;
            }

            // Collect makan data
            const sarapanChecked = Array.from(document.querySelectorAll('.sarapan-check:checked')).map(cb => cb.value);
            const siangChecked = Array.from(document.querySelectorAll('.siang-check:checked')).map(cb => cb.value);
            const malamChecked = Array.from(document.querySelectorAll('.malam-check:checked')).map(cb => cb.value);

            // Collect ibadah data
            let ibadahData = '';
            if (agama === 'Islam') {
                const ibadahChecked = Array.from(document.querySelectorAll('.ibadah-check:checked')).map(cb => cb.value);
                ibadahData = `${agama} - ${ibadahChecked.join(', ')}`;
            } else {
                const ibadahLainnya = document.getElementById('ibadahLainnya');
                ibadahData = ibadahLainnya ? ibadahLainnya.value : agama;
            }

            // Create jurnal entry
            const jurnalEntry = {
                siswaId: 999, // Demo siswa ID
                nama: 'Siswa Demo',
                kelas: 'XI',
                jurusan: 'IPA',
                agama: agama,
                tanggal: new Date().toISOString().split('T')[0],
                bangunPagi: waktuBangun,
                beribadah: ibadahData,
                berolahraga: `${jenisOlahraga} (${durasiOlahraga} menit)`,
                makanSehat: `Sarapan: ${sarapanChecked.length}/4, Siang: ${siangChecked.length}/5, Malam: ${malamChecked.length}/5`,
                gemarBelajar: kegiatanBelajar,
                bermasyarakat: kegiatanMasyarakat,
                tidurCepat: waktuTidur
            };

            // Add to data
            dataJurnal.push(jurnalEntry);
            updateRiwayatJurnal();

            alert('🎉 Jurnal berhasil disimpan! Terima kasih telah mengisi jurnal 7 kebiasaan hari ini dengan lengkap.');

            // Reset form
            document.querySelectorAll('#siswaDashboard input, #siswaDashboard textarea, #siswaDashboard select').forEach(input => {
                if (input.type === 'checkbox') {
                    input.checked = false;
                } else {
                    input.value = '';
                }
            });

            // Clear ibadah form
            document.getElementById('formIbadah').innerHTML = '';
        }

        // Student journal history functions
        function updateRiwayatJurnal() {
            const tbody = document.getElementById('tabelRiwayatJurnal');
            tbody.innerHTML = '';

            // Filter jurnal for current user (demo: show all)
            const userJurnal = dataJurnal.filter(j => j.siswaId === 999 || j.siswaId === 1 || j.siswaId === 2);

            if (userJurnal.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="px-4 py-8 text-center text-gray-500">Belum ada riwayat jurnal</td></tr>';
                return;
            }

            userJurnal.forEach((jurnal, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="px-4 py-2">${jurnal.tanggal}</td>
                    <td class="px-4 py-2">${jurnal.bangunPagi}</td>
                    <td class="px-4 py-2">${jurnal.beribadah.substring(0, 20)}...</td>
                    <td class="px-4 py-2">${jurnal.berolahraga.substring(0, 20)}...</td>
                    <td class="px-4 py-2">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">Lengkap</span>
                    </td>
                    <td class="px-4 py-2">
                        <button onclick="showDetailJurnal(${index})" class="bg-blue-500 text-white px-3 py-1 rounded text-xs hover:bg-blue-600">
                            <i class="fas fa-eye mr-1"></i>Detail
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function showDetailJurnal(index) {
            const userJurnal = dataJurnal.filter(j => j.siswaId === 999 || j.siswaId === 1 || j.siswaId === 2);
            const jurnal = userJurnal[index];
            if (!jurnal) return;

            currentJurnalDetail = jurnal;

            const content = document.getElementById('detailJurnalContent');
            content.innerHTML = `
                <div class="bg-gray-50 p-4 rounded-lg mb-4">
                    <h4 class="font-semibold text-gray-800 mb-2">Informasi Siswa</h4>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div><strong>Nama:</strong> ${jurnal.nama}</div>
                        <div><strong>Kelas:</strong> ${jurnal.kelas}</div>
                        <div><strong>Jurusan:</strong> ${jurnal.jurusan}</div>
                        <div><strong>Agama:</strong> ${jurnal.agama}</div>
                        <div><strong>Tanggal:</strong> ${jurnal.tanggal}</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-yellow-800 mb-2 flex items-center">
                            • 1. Bangun Pagi
                        </h4>
                        <p class="text-sm text-yellow-700">${jurnal.bangunPagi}</p>
                    </div>

                    <div class="bg-green-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-green-800 mb-2 flex items-center">
                            • 2. Beribadah
                        </h4>
                        <p class="text-sm text-green-700">${jurnal.beribadah}</p>
                    </div>

                    <div class="bg-red-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-red-800 mb-2 flex items-center">
                            • 3. Berolahraga
                        </h4>
                        <p class="text-sm text-red-700">${jurnal.berolahraga}</p>
                    </div>

                    <div class="bg-orange-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-orange-800 mb-2 flex items-center">
                            • 4. Makan Sehat dan Bergizi
                        </h4>
                        <p class="text-sm text-orange-700">${jurnal.makanSehat}</p>
                    </div>

                    <div class="bg-purple-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-purple-800 mb-2 flex items-center">
                            • 5. Gemar Belajar
                        </h4>
                        <p class="text-sm text-purple-700">${jurnal.gemarBelajar}</p>
                    </div>

                    <div class="bg-indigo-50 p-4 rounded-lg">
                        <h4 class="font-semibold text-indigo-800 mb-2 flex items-center">
                            • 6. Bermasyarakat
                        </h4>
                        <p class="text-sm text-indigo-700">${jurnal.bermasyarakat}</p>
                    </div>

                    <div class="bg-blue-50 p-4 rounded-lg col-span-1 md:col-span-2 lg:col-span-1">
                        <h4 class="font-semibold text-blue-800 mb-2 flex items-center">
                            • 7. Tidur Cepat
                        </h4>
                        <p class="text-sm text-blue-700">${jurnal.tidurCepat}</p>
                    </div>
                </div>
            `;

            document.getElementById('modalDetailJurnal').classList.remove('hidden');
        }

        function closeDetailJurnal() {
            document.getElementById('modalDetailJurnal').classList.add('hidden');
            currentJurnalDetail = null;
        }

        function cetakPDF() {
            if (!currentJurnalDetail) return;

            const jurnal = currentJurnalDetail;
            
            // Create PDF content
            const pdfContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Jurnal 7 Kebiasaan - ${jurnal.nama}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 10px; }
                        .info-table { width: 100%; margin-bottom: 20px; border-collapse: collapse; }
                        .info-table td { padding: 8px; border: 1px solid #ddd; }
                        .habit-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                        .habit-table th, .habit-table td { padding: 12px; border: 1px solid #333; text-align: left; }
                        .habit-table th { background-color: #f5f5f5; font-weight: bold; }
                        .signature-section { margin-top: 50px; display: flex; justify-content: space-between; }
                        .signature-box { width: 200px; text-align: center; }
                        .signature-line { border-top: 1px solid #333; margin-top: 60px; padding-top: 5px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>JURNAL 7 KEBIASAAN ANAK INDONESIA HEBAT</h1>
                        <p>Laporan Aktivitas Harian Siswa</p>
                    </div>

                    <table class="info-table">
                        <tr>
                            <td><strong>Nama Siswa</strong></td>
                            <td>${jurnal.nama}</td>
                            <td><strong>Kelas</strong></td>
                            <td>${jurnal.kelas}</td>
                        </tr>
                        <tr>
                            <td><strong>Jurusan</strong></td>
                            <td>${jurnal.jurusan}</td>
                            <td><strong>Agama</strong></td>
                            <td>${jurnal.agama}</td>
                        </tr>
                        <tr>
                            <td><strong>Tanggal</strong></td>
                            <td>${jurnal.tanggal}</td>
                            <td><strong>Hari</strong></td>
                            <td>${new Date(jurnal.tanggal).toLocaleDateString('id-ID', { weekday: 'long' })}</td>
                        </tr>
                    </table>

                    <table class="habit-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Kebiasaan</th>
                                <th>Aktivitas yang Dilakukan</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>• Bangun Pagi</td>
                                <td>Bangun pukul ${jurnal.bangunPagi}</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>• Beribadah</td>
                                <td>${jurnal.beribadah}</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>• Berolahraga</td>
                                <td>${jurnal.berolahraga}</td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>• Makan Sehat dan Bergizi</td>
                                <td>${jurnal.makanSehat}</td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>• Gemar Belajar</td>
                                <td>${jurnal.gemarBelajar}</td>
                            </tr>
                            <tr>
                                <td>6</td>
                                <td>• Bermasyarakat</td>
                                <td>${jurnal.bermasyarakat}</td>
                            </tr>
                            <tr>
                                <td>7</td>
                                <td>• Tidur Cepat</td>
                                <td>Tidur pukul ${jurnal.tidurCepat}</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="signature-section">
                        <div class="signature-box">
                            <div class="signature-line">Orang Tua/Wali Murid</div>
                        </div>
                        <div class="signature-box">
                            <div class="signature-line">Guru Wali</div>
                        </div>
                    </div>
                </body>
                </html>
            `;

            // Create and download PDF
            const blob = new Blob([pdfContent], { type: 'text/html' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Jurnal_7_Kebiasaan_${jurnal.nama}_${jurnal.tanggal}.html`;
            a.click();
            window.URL.revokeObjectURL(url);

            alert('File jurnal berhasil didownload! Buka file HTML tersebut di browser dan cetak sebagai PDF.');
        }

        // Excel upload for jurusan
        document.getElementById('fileJurusan').addEventListener('change', function() {
            uploadJurusan();
        });

        function uploadJurusan() {
            const fileInput = document.getElementById('fileJurusan');
            const file = fileInput.files[0];
            
            if (!file) return;

            // Validate file type
            const allowedTypes = [
                'application/vnd.ms-excel',
                'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
            ];
            
            if (!allowedTypes.includes(file.type) && !file.name.match(/\.(xls|xlsx)$/i)) {
                alert('Format file tidak valid! Gunakan file Excel (.xls atau .xlsx)');
                return;
            }

            // Simulate file processing
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    // Sample data from Excel
                    const sampleDataFromExcel = [
                        { kode: 'TKJ', nama: 'Teknik Komputer dan Jaringan', deskripsi: 'Jurusan yang mempelajari teknologi komputer dan jaringan' },
                        { kode: 'MM', nama: 'Multimedia', deskripsi: 'Jurusan yang mempelajari desain grafis dan multimedia' }
                    ];
                    
                    // Add to existing data
                    sampleDataFromExcel.forEach(jurusan => {
                        const newId = dataJurusan.length > 0 ? Math.max(...dataJurusan.map(j => j.id)) + 1 : 1;
                        dataJurusan.push({
                            id: newId,
                            kode: jurusan.kode,
                            nama: jurusan.nama,
                            deskripsi: jurusan.deskripsi
                        });
                    });
                    
                    updateTabelJurusan();
                    
                    alert(`✅ File Excel berhasil diupload!\n${sampleDataFromExcel.length} data jurusan baru telah ditambahkan ke sistem.`);
                    
                    // Reset file input
                    fileInput.value = '';
                    
                } catch (error) {
                    alert('❌ Terjadi kesalahan saat memproses file Excel. Pastikan format file sesuai dengan template yang disediakan.');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        // Close modal when clicking outside
        document.getElementById('modalDetailMakan').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDetailMakan();
            }
        });

        document.getElementById('modalDetailJurnal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDetailJurnal();
            }
        });

        document.getElementById('modalEditGuru').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEditGuru();
            }
        });

        document.getElementById('modalEditSiswa').addEventListener('click', function(e) {
            if (e.target === this) {
                closeEditSiswa();
            }
        });

        document.getElementById('modalTambahJurusan').addEventListener('click', function(e) {
            if (e.target === this) {
                closeTambahJurusan();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98490ca0e64d9cd6',t:'MTc1ODc4Nzg3MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
